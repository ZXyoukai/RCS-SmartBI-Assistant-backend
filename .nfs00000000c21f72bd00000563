#!/usr/bin/env python3
"""
Teste da API Gemini
"""
import asyncio
import os
from dotenv import load_dotenv

# Carregar variÃ¡veis de ambiente
load_dotenv()

async def test_gemini_integration():
    print("ğŸ§ª Testando integraÃ§Ã£o com Gemini...")
    
    try:
        from gemini_analyzer import GeminiAnalyzer
        
        # Inicializar o analisador
        analyzer = GeminiAnalyzer()
        
        # Verificar configuraÃ§Ã£o
        model_info = analyzer.get_model_info()
        print(f"ğŸ“Š ConfiguraÃ§Ã£o do modelo: {model_info}")
        
        # Testar conexÃ£o
        if analyzer.check_connection():
            print("âœ… ConexÃ£o com Gemini OK!")
            
            # Teste de anÃ¡lise simples
            test_data = """id,produto,vendas,regiao
1,Laptop,1500,Norte
2,Mouse,50,Sul
3,Teclado,120,Centro"""
            
            data_info = {
                'rows': 3,
                'columns': 4,
                'column_names': ['id', 'produto', 'vendas', 'regiao']
            }
            
            print("ğŸ¤– Executando anÃ¡lise de teste...")
            result = await analyzer.analyze_data(test_data, data_info, 'csv')
            
            print("âœ… AnÃ¡lise executada com sucesso!")
            print(f"â±ï¸ Tempo de processamento: {result['processing_time']}s")
            print(f"ğŸ”§ Modelo usado: {result['model_used']}")
            print(f"ğŸ“ Primeiros 300 caracteres da resposta:")
            print("-" * 50)
            print(result['gemini_response'][:300] + "...")
            
        else:
            print("âŒ Falha na conexÃ£o com Gemini")
            
    except Exception as e:
        print(f"âŒ Erro no teste: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    asyncio.run(test_gemini_integration())
