#!/usr/bin/env python3
"""
Teste da configuraÃ§Ã£o da API Key do Gemini
"""
import os
from dotenv import load_dotenv

# Carregar .env
load_dotenv()

print("=== TESTE DE CONFIGURAÃ‡ÃƒO DA API KEY ===")
print()

# 1. Verificar se arquivo .env existe
env_path = ".env"
if os.path.exists(env_path):
    print("âœ… Arquivo .env encontrado")
    
    # Ler conteÃºdo do .env
    with open(env_path, 'r') as f:
        content = f.read()
        print("\nðŸ“„ ConteÃºdo do .env:")
        for i, line in enumerate(content.split('\n'), 1):
            if line.strip():
                if 'GEMINI_API_KEY' in line:
                    print(f"   {i}: {line} <-- ESTA LINHA")
                else:
                    print(f"   {i}: {line}")
else:
    print("âŒ Arquivo .env nÃ£o encontrado")

print()

# 2. Verificar variÃ¡vel de ambiente
api_key_from_env = os.getenv("GEMINI_API_KEY")
if api_key_from_env:
    print(f"ðŸ”‘ API Key carregada: {api_key_from_env[:20]}...")
    print(f"ðŸ“ Tamanho da API Key: {len(api_key_from_env)} caracteres")
else:
    print("âŒ GEMINI_API_KEY nÃ£o encontrada nas variÃ¡veis de ambiente")

print()

# 3. Testar importaÃ§Ã£o do GeminiAnalyzer
print("ðŸ§ª Testando GeminiAnalyzer:")
try:
    from gemini_analyzer import GeminiAnalyzer
    analyzer = GeminiAnalyzer()
    
    print(f"   ðŸ”§ API Key no analyzer: {analyzer.api_key[:20] if analyzer.api_key else 'None'}...")
    print(f"   âœ… Modelo configurado: {analyzer.model is not None}")
    
    model_info = analyzer.get_model_info()
    print(f"   ðŸ“Š Info do modelo: {model_info}")
    
    # Teste de conexÃ£o
    if analyzer.check_connection():
        print("   âœ… ConexÃ£o com Gemini funcionando!")
    else:
        print("   âŒ Falha na conexÃ£o com Gemini")
        
except Exception as e:
    print(f"   âŒ Erro: {e}")
    import traceback
    traceback.print_exc()

print()
print("=== FIM DO TESTE ===")
