#!/usr/bin/env python3
import os
import sys
import asyncio
from dotenv import load_dotenv

# Carrega .env
load_dotenv()

def test_api_key():
    print("🔑 Testando API Key do Gemini...")
    
    # Pega a API key
    api_key = os.getenv("GEMINI_API_KEY")
    if not api_key:
        print("❌ GEMINI_API_KEY não encontrada")
        return False
    
    print(f"✅ API Key encontrada: {api_key[:20]}...")
    
    try:
        import google.generativeai as genai
        genai.configure(api_key=api_key)
        
        model = genai.GenerativeModel('gemini-1.5-flash')
        response = model.generate_content("Test connection")
        
        print("✅ Conexão com Gemini funcionando!")
        print(f"📝 Resposta: {response.text[:50]}...")
        return True
        
    except Exception as e:
        print(f"❌ Erro na conexão: {e}")
        return False

if __name__ == "__main__":
    success = test_api_key()
    sys.exit(0 if success else 1)
